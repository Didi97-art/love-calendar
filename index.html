<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Love Calendar</title>
<style>
  body {
    font-family: Arial, sans-serif;
    max-width: 420px;
    margin: 20px auto;
    padding: 15px;
    background: #faf4f0;
    color: #4a3c3c;
  }
  h1 {
    text-align: center;
    color: #b35959;
  }
  label {
    display: block;
    margin-top: 10px;
    font-weight: 600;
  }
  input, select, textarea {
    width: 100%;
    padding: 7px;
    margin-top: 4px;
    border: 1px solid #ccaaaa;
    border-radius: 6px;
    font-size: 15px;
    box-sizing: border-box;
  }
  button {
    margin-top: 15px;
    width: 100%;
    padding: 12px;
    background-color: #b35959;
    border: none;
    color: white;
    font-size: 18px;
    border-radius: 7px;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  button:hover {
    background-color: #9d4949;
  }
  .feedback {
    margin-top: 15px;
    font-weight: bold;
    color: green;
    text-align: center;
  }
  .history {
    margin-top: 25px;
    background: #fff3f3;
    padding: 12px;
    border-radius: 8px;
    max-height: 200px;
    overflow-y: auto;
  }
  .event-item {
    border-bottom: 1px solid #d8b5b5;
    padding: 8px 0;
  }
  .event-item:last-child {
    border: none;
  }
</style>
</head>
<body>

<h1>–î–æ–±–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ</h1>
<form id="eventForm">
  <label for="title">–ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è *</label>
  <input type="text" id="title" name="title" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, –í—Å—Ç—Ä–µ—á–∞" />

  <label for="date">–î–∞—Ç–∞ *</label>
  <input type="date" id="date" name="date" required />

  <label for="time">–í—Ä–µ–º—è</label>
  <input type="time" id="time" name="time" />

  <label for="type">–¢–∏–ø —Å–æ–±—ã—Ç–∏—è</label>
  <select id="type" name="type">
    <option value="–í—Å—Ç—Ä–µ—á–∞">–í—Å—Ç—Ä–µ—á–∞</option>
    <option value="–ü—Ä–∞–∑–¥–Ω–∏–∫">–ü—Ä–∞–∑–¥–Ω–∏–∫</option>
    <option value="–ó–∞–¥–∞—á–∞">–ó–∞–¥–∞—á–∞</option>
    <option value="–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ">–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ</option>
  </select>

  <label for="emotion">–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ</label>
  <select id="emotion" name="emotion">
    <option value="üòä">üòä –†–∞–¥–æ—Å—Ç—å</option>
    <option value="üò¢">üò¢ –ì—Ä—É—Å—Ç—å</option>
    <option value="üòç">üòç –õ—é–±–æ–≤—å</option>
    <option value="üò†">üò† –ó–ª–æ—Å—Ç—å</option>
    <option value="üò¥">üò¥ –°–æ–Ω–ª–∏–≤–æ—Å—Ç—å</option>
  </select>

  <label for="notes">–ü—Ä–∏–º–µ—á–∞–Ω–∏—è</label>
  <textarea id="notes" name="notes" rows="3" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è..."></textarea>

  <button type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ Telegram</button>
</form>

<div class="feedback" id="feedback"></div>

<h2>–ò—Å—Ç–æ—Ä–∏—è —Å–æ–±—ã—Ç–∏–π</h2>
<div class="history" id="history"></div>

<script>
  const tg = window.Telegram?.WebApp;
  const form = document.getElementById('eventForm');
  const feedbackEl = document.getElementById('feedback');
  const historyEl = document.getElementById('history');

  // –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑ localStorage
  let eventsHistory = JSON.parse(localStorage.getItem('loveCalendarEvents') || '[]');

  function renderHistory() {
    if (eventsHistory.length === 0) {
      historyEl.innerHTML = '<i>–°–æ–±—ã—Ç–∏—è –µ—â—ë –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã</i>';
      return;
    }
    historyEl.innerHTML = eventsHistory.map(event => `
      <div class="event-item">
        <strong>${event.title}</strong> (${event.date} ${event.time || ''})<br/>
        –¢–∏–ø: ${event.type}, –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ: ${event.emotion || '-'}<br/>
        ${event.notes ? '–ü—Ä–∏–º–µ—á–∞–Ω–∏—è: ' + event.notes : ''}
      </div>
    `).join('');
  }

  renderHistory();

  form.addEventListener('submit', (e) => {
    e.preventDefault();

    const eventData = {
      title: form.title.value.trim(),
      date: form.date.value,
      time: form.time.value,
      type: form.type.value,
      emotion: form.emotion.value,
      notes: form.notes.value.trim(),
    };

    // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Telegram
    if (tg) {
      tg.sendData(JSON.stringify(eventData));
      tg.close();
    }

    // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–±—ã—Ç–∏–µ –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é
    eventsHistory.push(eventData);
    localStorage.setItem('loveCalendarEvents', JSON.stringify(eventsHistory));
    renderHistory();

    // –§–∏–¥–±—ç–∫
    feedbackEl.
  textContent = '–°–æ–±—ã—Ç–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ!';
    form.reset();

    setTimeout(() => {
      feedbackEl.textContent = '';
    }, 3000);
  });

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏–∑ Telegram
  if (!tg) {
    alert('–≠—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ Telegram WebApp.');
  }
</script>

</body>
</html>